CREATE DATABASE ps_gst_billing_task;

use ps_gst_billing_task;

CREATE TABLE user_account(
  id int NOT NULL AUTO_INCREMENT,
  username varchar(100) NOT NULL,
  email varchar(100) NOT NULL,
  password varchar(255) NOT NULL,
  gstin varchar(255) NULL,
  name varchar(255) NULL,
  company_name varchar(255) NULL,
  address varchar(255) NULL,
  PRIMARY KEY (id)
);

CREATE TABLE role(
  id int NOT NULL AUTO_INCREMENT,
  role_name varchar(100) NOT NULL,
  PRIMARY KEY (id)
);


CREATE TABLE user_has_role(
  id int NOT NULL AUTO_INCREMENT,
user_acc_id int NOT NULL,
role_id int NOT NULL,
  FOREIGN KEY(user_acc_id) REFERENCES `user_account` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY(role_id) REFERENCES `role` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  timestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (id)
);
CREATE TABLE customer(
  id int(10) NOT NULL AUTO_INCREMENT,
  f_name varchar(255)  NULL,
  l_name varchar(255)  NULL,
  mobile_no bigint(10)  NULL,
  address varchar(255)  NULL,
  is_active BOOLEAN default true,
  PRIMARY KEY (id)
);
CREATE TABLE vendor(
  prefix varchar(4) NOT NULL DEFAULT 'VEN_',
  id int(10) NOT NULL AUTO_INCREMENT,
  name varchar(255)  NULL,
  mobile_no bigint(10)  NULL,
  address varchar(255)  NULL,
  is_active BOOLEAN default true,
  PRIMARY KEY (id),
  UNIQUE KEY (`prefix`, `id`)
);
CREATE TABLE categorie(
  id int(10) NOT NULL AUTO_INCREMENT,
  name varchar(255)  NULL,
  description varchar(255)  NULL,
  is_active BOOLEAN default true,
  PRIMARY KEY (id)
);
CREATE TABLE product(
id int NOT NULL AUTO_INCREMENT,
name varchar(255) NOT NULL,
cat_id int NOT NULL,
p_model_no varchar(255) NULL,
p_hsn_code varchar(255) NULL,
p_color varchar(50) NULL,
vendor_id int NOT NULL,
p_warranty varchar(100) NULL,
p_mrp_price decimal(8,2) NOT NULL,
p_sale_price decimal(8,2) NOT NULL,
gst_percentage decimal(8,2) NULL, 
limited BOOLEAN default true,
in_stock decimal(8,2) NOT NULL,
active_for_sale BOOLEAN default true,
FOREIGN KEY(vendor_id) REFERENCES `vendor` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(cat_id) REFERENCES `categorie` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
time_created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
time_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (id)
);

CREATE TABLE product_history(
id int NOT NULL AUTO_INCREMENT,
name varchar(255) NOT NULL,
cat_id int NOT NULL,
p_model_no varchar(255) NULL,
p_hsn_code varchar(255) NULL,
p_color varchar(50) NULL,
vendor_id int NOT NULL,
p_warranty varchar(100) NULL,
p_mrp_price decimal(8,2) NOT NULL,
p_sale_price decimal(8,2) NOT NULL,
gst_percentage decimal(8,2) NULL, 
limited BOOLEAN default true,
in_stock decimal(8,2) NOT NULL,
active_for_sale BOOLEAN default true,
p_id int NOT NULL,
FOREIGN KEY(p_id) REFERENCES `product` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(vendor_id) REFERENCES `vendor` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(cat_id) REFERENCES `categorie` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
time_created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
time_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (id)
);


CREATE TABLE sale_status(
  id int NOT NULL AUTO_INCREMENT,
  status_name varchar(255) NOT NULL,
  sale_payment_type varchar(255) NOT NULL,
  PRIMARY KEY (id)
);
CREATE TABLE sale(
id int NOT NULL AUTO_INCREMENT,
sale_info text NOT NULL,
time_paid TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
time_created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
sale_status_id int NULL,
user_id int NOT NULL,
with_gst BOOLEAN,
FOREIGN KEY(user_id) REFERENCES `user_account` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  PRIMARY KEY (id)
);


username:admin
password:admin1
email:admin@admin.com
name:Vikram Jotiba Patil
company_name:Jobita Technologies
address:365/1, Janta Colony Road, Kallehol, Belagavi(Belgaum), Karnataka, 591128
gstin:29DRUPP3312J1Z6